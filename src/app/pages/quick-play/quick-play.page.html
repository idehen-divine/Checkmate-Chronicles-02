<ion-content>
  <app-header-toolbar title="Quick Play Lobby"></app-header-toolbar>

  <div class="quick-play-lobby">
    
    <!-- Game Toolbar (like game page) -->
    <div class="game-toolbar">
      <ion-button 
        fill="clear" 
        size="small"
        (click)="openChatComingSoon()">
        <ion-icon name="chatbubble" slot="start"></ion-icon>
        Chat
      </ion-button>
      
      <ion-button 
        fill="clear" 
        size="small"
        (click)="openMoreOptions($event)">
        <ion-icon name="ellipsisVertical" slot="start"></ion-icon>
        More
      </ion-button>
    </div>

    <!-- Game Info -->
    <div class="game-info">
      <h1>{{ gameName }}</h1>
      <div class="game-settings">
        <ion-chip color="primary">
          <ion-icon name="time"></ion-icon>
          <ion-label>{{ gameMinutes }} minutes</ion-label>
        </ion-chip>
        <ion-chip *ngIf="hintsEnabled" color="secondary">
          <ion-icon name="bulb"></ion-icon>
          <ion-label>Hints enabled</ion-label>
        </ion-chip>
      </div>
    </div>

    <!-- Players Section -->
    <div class="players-section">
      
      <!-- Current Player -->
      <div class="player-card current-player">
        <div class="player-info">
          <ion-avatar>
            <img [src]="currentPlayer?.avatar || '/assets/images/profile-avatar.png'" alt="Your avatar">
          </ion-avatar>
          <div class="player-details">
            <h3>{{ currentPlayer?.username || 'You' }}</h3>
            <p>1200 ELO</p>
            <div class="player-label">You</div>
          </div>
        </div>
        <div class="player-status">
          <ion-icon 
            [name]="isReady ? 'checkmark' : 'time'" 
            [color]="isReady ? 'success' : 'medium'">
          </ion-icon>
          <span [class.ready]="isReady">
            {{ isReady ? 'Ready' : 'Not Ready' }}
          </span>
        </div>
      </div>

      <div class="vs-divider">
        <span>VS</span>
      </div>

      <!-- Opponent -->
      <div class="player-card opponent-player">
        <div *ngIf="opponent" class="player-info">
          <ion-avatar>
            <img [src]="opponent.avatar || '/assets/images/profile-avatar.png'" alt="Opponent avatar">
          </ion-avatar>
          <div class="player-details">
            <h3>{{ opponent.username }}</h3>
            <p>1650 ELO</p>
            <div class="player-label">Opponent</div>
          </div>
        </div>
        
        <div *ngIf="!opponent" class="waiting-opponent">
          <ion-spinner name="dots" color="medium"></ion-spinner>
          <h3>Waiting for opponent...</h3>
          <p>Looking for another player</p>
        </div>

        <div *ngIf="opponent" class="player-status">
          <ion-icon 
            [name]="opponent.ready ? 'checkmark' : 'time'" 
            [color]="opponent.ready ? 'success' : 'medium'">
          </ion-icon>
          <span [class.ready]="opponent.ready">
            {{ opponent.ready ? 'Ready' : 'Not Ready' }}
          </span>
        </div>
      </div>
    </div>

    <!-- Game Status -->
    <div class="game-status">
      <div class="status-message">
        <h3>{{ getGameStatus() }}</h3>
      </div>
    </div>

    <!-- Ready Button -->
    <div class="ready-section">
      <ion-button 
        expand="block" 
        size="large"
        [color]="isReady ? 'medium' : 'success'"
        (click)="toggleReady()"
        [disabled]="!canClickReady || gameStarting">
        <ion-icon 
          [name]="isReady ? 'checkmark' : 'play'" 
          slot="start">
        </ion-icon>
        {{ isReady ? 'Cancel Ready' : 'Ready to Play' }}
      </ion-button>
      
      <p class="ready-note" *ngIf="!canClickReady">
        Ready button will be enabled when another player joins
      </p>
    </div>
  </div>
</ion-content>
